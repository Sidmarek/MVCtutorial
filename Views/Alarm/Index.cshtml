@using MVCtutorial.Alarms.Models
@model AlarmFormModel


@{
    ViewBag.Title = "Alarms";
}
<h2 class="header">Alarms</h2>
<div class="top">
    <div class="row">
        @using (Html.BeginForm("Form", "Alarm", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
            {
            <div class="form-group">
                <div class="first">
                    <div class="col-md-offset-2 col-md-10" id="1">
                        <input type="submit" value="<-" onclick="pageDecrement()" class="btn btn-default" />
                        @ViewBag.PageNumber
                        <input type="submit" value="->" onclick="pageIncrement()" class="btn btn-default" />
                        @Html.HiddenFor(m => m.someId, new { id = "someId" })
                        <script type="text/javascript">
                            function pageIncrement() { var PageNumber = @ViewBag.PageNumber;  PageNumber++; var some = document.getElementById("someId").value = PageNumber;}
                            function pageDecrement() { if (@ViewBag.PageNumber>0){ var PageNumber = @ViewBag.PageNumber;  PageNumber--; var some = document.getElementById("someId").value = PageNumber; }}
                        </script>
                    </div>
                </div>
                <div class="second">
                    <div class="col-md-offset-2 col-md-10" id="2">
                        <input type="submit" value="10" onclick="NumberOfRecords10()" class="btn btn-default" />
                        <input type="submit" value="20" onclick="NumberOfRecords20()" class="btn btn-default" />
                        <input type="submit" value="30" onclick="NumberOfRecords30()" class="btn btn-default" />
                        @Html.HiddenFor(m => m.NumberOfRecords, new { id = "NumberOfRecords" })
                        <script type="text/javascript">
                            function NumberOfRecords10() { var NumberOfRecords = @ViewBag.NumberOfRecords;  NumberOfRecords = 10; var some = document.getElementById("NumberOfRecords").value = NumberOfRecords;}
                            function NumberOfRecords20() { var NumberOfRecords = @ViewBag.NumberOfRecords;  NumberOfRecords = 20; var some = document.getElementById("NumberOfRecords").value = NumberOfRecords;}
                            function NumberOfRecords30() { var NumberOfRecords = @ViewBag.NumberOfRecords;  NumberOfRecords = 30; var some = document.getElementById("NumberOfRecords").value = NumberOfRecords;}
                        </script>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
<div class="bottom">
        <table class="tg">
        <tr>
            <th class="tg-yw4l">Id</th>
            <th class="tg-yw42">Alarm Label</th>
            <th class="tg-yw43">Origin Time</th>
            <th class="tg-yw44">ExpiryTime</th>
        </tr>

        @for (int i = 0; i < 20; i++)
        {
            <tr>
                <td class="tg-yw4l">@ViewBag.Id[i]</td>
                <td class="tg-yw42">@ViewBag.Label[i]</td>
                <td class="tg-yw43" id="date_@i">@ViewBag.originTime[i]</td>        
                <td class="tg-yw44"  id="expDate_@i">@ViewBag.expTime[i]</td>
            </tr>
        }
    </table>
    @for (int i = 0; i < 20; i++)
    {
        <script>
        var date = "@ViewBag.originTime[i]";
        var expDate = "@ViewBag.expTime[i]";

                var localDateTime = DateTime(date);
                document.getElementById("date_" + "@i").innerHTML = localDateTime;
                var localExpDateTime = DateTime(expDate);
                document.getElementById("expDate_" + "@i").innerHTML = localExpDateTime;

                function DateTime(date){
                    var d = new Date(date);
                    var offset = d.getTimezoneOffset();
                    var offseted_miliseconds = d.getTime() - (offset*60000);
                    var DateTime = new Date(offseted_miliseconds);
                    var localDateTime = DateTime.toLocaleString();
                    console.log(DateTime);
                    console.log(localDateTime);
                    return localDateTime;
                }
    </script>
    }
</div>
